
CREATE FUNCTION addemergenza(inome VARCHAR, icognome VARCHAR, itelefono BIGINT, iemail VARCHAR) RETURNS SETOF integer AS
$$
BEGIN
IF NOT EXISTS(SELECT FROM emergenza WHERE nome=inome AND cognome=icognome AND telefono=itelefono AND email=iemail) THEN
    INSERT INTO emergenza (nome,cognome,telefono,email) VALUES (inome,icognome,itelefono,iemail);
    END IF;
    RETURN QUERY SELECT id FROM emergenza WHERE nome=inome AND cognome=icognome AND telefono=itelefono AND email=iemail;
END$$ LANGUAGE plpgsql;;
SELECT * FROM addemegenza("Pino","GINO",312313,"test.com");